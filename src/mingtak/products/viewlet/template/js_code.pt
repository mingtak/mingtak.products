<?python
import json
request = econtext['request']
itemInCart = request.cookies.get('itemInCart', 'null')
cart_items = len(json.loads(itemInCart))
?>

<div id='vue_js_code'>

<h1>${view/cart_items}</h1>

<!-- 上線前要改 min <script src="https://vuejs.org/js/vue.min.js" /> -->
<script src="https://vuejs.org/js/vue.js" />
<script src="https://cdn.jsdelivr.net/vue.resource/1.0.2/vue-resource.min.js"></script>
<script>
var vm = new Vue({
  el: 'body',
  data: {
    message: '${itemInCart}',
    cart_items: '${cart_items}',
  },
  methods: {
    addToCart: function (action, uid) {
      // GET
      this.$http.get('/outlet/cart_update?action=' + action + '&uid=' + uid).then((response) => {
        // success callback
           jsonData = JSON.parse(response.body);
           l = 0;
           for(i in jsonData){
             if (jsonData.hasOwnProperty(i)){
               l++;
             };
           };
           this.message = jsonData;
           this.cart_items = l;
        }, (response) => {
          // error callback
            console.log('error');
      });
    }
  }
})
</script>

</div>
